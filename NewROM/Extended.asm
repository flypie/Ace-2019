
	INCLUDE "iodefs.inc"

	org	03000H
	
	PUBLIC NEWROMSTART, SIOINTTBL

	.EXTERN CTC0INT,CTC1INT,CTC2INT,CTC3INT,INIT_CTC
	.EXTERN INIT_SIO
	.EXTERN SIOAINT_TBE,SIOAINT_ESC,SIOAINT_RCA,SIOAINT_SRC,SIOBINT_TBE,SIOBINT_ESC,SIOBINT_RCA,SIOBINT_SRC

	.EXTERN PIOAINT,PIOBINT,PIACINT,INIT_PIO
	.EXTERN L009B


	
INTTBL:
PIOINTTBL:
	DW  PIOAINT ;int 0

	org	03008H
PIOINTCTC:
	DW  CTC0INT
	DW  CTC1INT
	DW  CTC2INT
	DW  CTC3INT

	org	03010H
SIOINTTBL:
	DW  SIOBINT_TBE
	DW  SIOBINT_ESC
	DW  SIOBINT_RCA
	DW  SIOBINT_SRC
	DW  SIOAINT_TBE
	DW  SIOAINT_ESC
	DW  SIOAINT_RCA
	DW  SIOAINT_SRC

	.DEFINE DEUCEROM
	.SECTION DEUCEROM

NEWROMSTART:


	LD		HL,02000h
Looper:
	LD		C,(HL)
	INC		C
	LD		(HL),C
	JP Looper

	call INIT_KIO
	JP	L009B


INIT_KIO:
	ld	A,(1<<7)|011B	; SIOPIA Moude = SIP & Daischain = CTC,SIO,PIO 
	ld	BC,KIOCMDA
	out	(BC),A

	call INIT_CTC
	call INIT_PIO
	call INIT_SIO

	IM	2
	LD	A,INTTBL/256
	LD	I, A
	EI


