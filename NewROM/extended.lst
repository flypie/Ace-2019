Zilog Macro Assembler.  Version K2.14    27-Jan-120    21:37:00    Page:    1


c:\users\john bradley\dropbox\ace-2019\newrom\extended.asm

Location Object              Type  Line Source
                             A        1 
                             A        2 	INCLUDE "iodefs.inc"
                   000000FC  B        1 KIOBASE	equ	0FCh
                             B        2 
                   00000000  B        3 PIOIOBASE	equ	00B
                   00000001  B        4 CTCIOBASE	equ	01B
                   00000002  B        5 SIOIOBASE	equ	10B
                   00000003  B        6 PIAIOBASE	equ	11B
                   00000003  B        7 KIOIOBASE	equ	11B
                             B        8 
                   00000000  B        9 PIOPORTADATA	equ	00b
                   00000001  B       10 PIOPORTACMD		equ	01b
                   00000000  B       11 PIOPORTBDATA	equ	00b
                   00000001  B       12 PIOPORTBCMD		equ	01b
                             B       13 
                   00000000  B       14 CTCCHANNEL0		equ	00b
                   00000001  B       15 CTCCHANNEL1		equ	01b
                   00000002  B       16 CTCCHANNEL2		equ	10b
                   00000003  B       17 CTCCHANNEL3		equ	11b
                             B       18 
                   00000000  B       19 SIOPORTADATA	equ	00b
                   00000001  B       20 SIOPORTACMD		equ	01b
                   00000000  B       21 SIOPORTBDATA	equ	00b
                   00000001  B       22 SIOPORTBCMD		equ	01b
                             B       23 
                   00000000  B       24 PIAPORTCDATA	equ	00b
                   00000001  B       25 PIAPORTCCMD		equ	01b
                             B       26 
                   00000002  B       27 KIOCOMMANDA		equ	10b
                   00000003  B       28 KIOCOMMANDB		equ	11b
                             B       29 
                             B       30 MAKEPORT	MACRO	Name,Base,Device,Register
                             B       31 Name equ Base|(Device<<8)|(Register<<10)
                             B       32 	endmac 
                             B       33 
                             B       34 
                             B       35 	MAKEPORT PIOADATA,KIOBASE,PIOIOBASE,PIOPORTADATA
                   000000FC  B+      35 Name equ Base|(Device<<8)|(Register<<10)
                             B       36 	MAKEPORT PIOACMD,KIOBASE,PIOIOBASE,PIOPORTACMD
                   000004FC  B+      36 Name equ Base|(Device<<8)|(Register<<10)
                             B       37 	MAKEPORT PIOBDATA,KIOBASE,PIOIOBASE,PIOPORTBDATA
                   000000FC  B+      37 Name equ Base|(Device<<8)|(Register<<10)
                             B       38 	MAKEPORT PIOBCMD,KIOBASE,PIOIOBASE,PIOPORTBCMD
                   000004FC  B+      38 Name equ Base|(Device<<8)|(Register<<10)
                             B       39 
                             B       40 	MAKEPORT CTCCH0,KIOBASE,CTCIOBASE,CTCCHANNEL0
                   000001FC  B+      40 Name equ Base|(Device<<8)|(Register<<10)
                             B       41 	MAKEPORT CTCCH1,KIOBASE,CTCIOBASE,CTCCHANNEL1
                   000005FC  B+      41 Name equ Base|(Device<<8)|(Register<<10)
                             B       42 	MAKEPORT CTCCH2,KIOBASE,CTCIOBASE,CTCCHANNEL2
                   000009FC  B+      42 Name equ Base|(Device<<8)|(Register<<10)
                             B       43 	MAKEPORT CTCCH3,KIOBASE,CTCIOBASE,CTCCHANNEL3
                   00000DFC  B+      43 Name equ Base|(Device<<8)|(Register<<10)
                             B       44 
                             B       45 	MAKEPORT SIOADATA,KIOBASE,SIOIOBASE,SIOPORTADATA
                   000002FC  B+      45 Name equ Base|(Device<<8)|(Register<<10)
                             B       46 	MAKEPORT SIOACMD,KIOBASE,SIOIOBASE,SIOPORTACMD
                   000006FC  B+      46 Name equ Base|(Device<<8)|(Register<<10)
Zilog Macro Assembler.  Version K2.14    27-Jan-120    21:37:00    Page:    2


iodefs.inc

Location Object              Type  Line Source
                             B       47 	MAKEPORT SIOBDATA,KIOBASE,SIOIOBASE,SIOPORTBDATA
                   000002FC  B+      47 Name equ Base|(Device<<8)|(Register<<10)
                             B       48 	MAKEPORT SIOBCMD,KIOBASE,SIOIOBASE,SIOPORTBCMD
                   000006FC  B+      48 Name equ Base|(Device<<8)|(Register<<10)
                             B       49 
                             B       50 	MAKEPORT PIOCDATA,KIOBASE,PIAIOBASE,PIAPORTCDATA
                   000003FC  B+      50 Name equ Base|(Device<<8)|(Register<<10)
                             B       51 	MAKEPORT PIOCCMD,KIOBASE,PIAIOBASE,PIAPORTCCMD
                   000007FC  B+      51 Name equ Base|(Device<<8)|(Register<<10)
                             B       52 
                             B       53 	MAKEPORT KIOCMDA,KIOBASE,KIOIOBASE,KIOCOMMANDA
                   00000BFC  B+      53 Name equ Base|(Device<<8)|(Register<<10)
                             B       54 	MAKEPORT KIOCMDB,KIOBASE,KIOIOBASE,KIOCOMMANDB
                   00000FFC  B+      54 Name equ Base|(Device<<8)|(Register<<10)
                             B       55 
                             B       56 	
                   000000F0  B       57 WDTMT	equ	0F0h
                   000000F1  B       58 WDTCR	equ	0F1h
                             B       59 
                   000000F4  B       60 IPR		equ	0F4h
                             B       61 
                   000000EE  B       62 SCRP	equ	0EEh
                   000000EF  B       63 SCDP	equ	0EFh
                             B       64 
                   00000020  B       65 SERIALTXBUFFLEN	equ	020h	;must be power of 2
                             B       66 
                             B       67 DEFB MACRO P1
                             B       68 	DB P1
                             B       69 	MACEND
                             B       70 
                             B       71 DEFW MACRO P1
                             B       72 	DW P1
                             B       73 	MACEND
                             B       74 
                             B       75 DEFM MACRO P1
                             B       76 	DB P1
                             B       77 	MACEND
                             B       78 
                             B       79 
                             A        3 
                             A        4 	org	03000H
                             A        5 	
                             A        6 	PUBLIC NEWROMSTART, SIOINTTBL
                             A        7 
                             A        8 	.EXTERN CTC0INT,CTC1INT,CTC2INT,CTC3INT,INIT_CTC
                             A        9 	.EXTERN INIT_SIO
                             A       10 	.EXTERN SIOAINT_TBE,SIOAINT_ESC,SIOAINT_RCA,SIOAINT_SRC,SIOBINT_TBE,SIOBINT_ESC,SIOBINT_RCA,SIOBINT_SRC
                             A       11 
                             A       12 	.EXTERN PIOAINT,PIOBINT,PIACINT,INIT_PIO
                             A       13 	.EXTERN L009B
                             A       14 
                             A       15 
                             A       16 	
00003000                     A       17 INTTBL:
00003000                     A       18 PIOINTTBL:
00003000 00 00               A       19 	DW  PIOAINT ;int 0
                             A       20 
                             A       21 	org	03008H
Zilog Macro Assembler.  Version K2.14    27-Jan-120    21:37:00    Page:    3


c:\users\john bradley\dropbox\ace-2019\newrom\extended.asm

Location Object              Type  Line Source
00003008                     A       22 PIOINTCTC:
00003008 00 00               A       23 	DW  CTC0INT
0000300A 00 00               A       24 	DW  CTC1INT
0000300C 00 00               A       25 	DW  CTC2INT
0000300E 00 00               A       26 	DW  CTC3INT
                             A       27 
                             A       28 	org	03010H
00003010                     A       29 SIOINTTBL:
00003010 00 00               A       30 	DW  SIOBINT_TBE
00003012 00 00               A       31 	DW  SIOBINT_ESC
00003014 00 00               A       32 	DW  SIOBINT_RCA
00003016 00 00               A       33 	DW  SIOBINT_SRC
00003018 00 00               A       34 	DW  SIOAINT_TBE
0000301A 00 00               A       35 	DW  SIOAINT_ESC
0000301C 00 00               A       36 	DW  SIOAINT_RCA
0000301E 00 00               A       37 	DW  SIOAINT_SRC
                             A       38 
                             A       39 	.DEFINE DEUCEROM
                             A       40 	.SECTION DEUCEROM
                             A       41 
00000000                     A       42 NEWROMSTART:
                             A       43 
00000000 CD 06 00            A       44 	call INIT_KIO
00000003 C3 00 00            A       45 	JP	L009B
                             A       46 
                             A       47 
00000006                     A       48 INIT_KIO:
00000006 3A 83 00            A       49 	ld	A,(1<<7)|011B	; SIOPIA Moude = SIP & Daischain = CTC,SIO,PIO 
00000009 01 FC 0B            A       50 	ld	BC,KIOCMDA
0000000C ED 79               A       51 	out	(BC),A
                             A       52 
0000000E CD 00 00            A       53 	call INIT_CTC
00000011 CD 00 00            A       54 	call INIT_PIO
00000014 CD 00 00            A       55 	call INIT_SIO
                             A       56 
00000017 ED 5E               A       57 	IM	2
00000019 3E 30               A       58 	LD	A,INTTBL/256
0000001B ED 47               A       59 	LD	I, A
0000001D FB                  A       60 	EI
                             A       61 
                             A       62 
Zilog Macro Assembler.  Version K2.14    27-Jan-120    21:37:00    Page:    4


c:\users\john bradley\dropbox\ace-2019\newrom\extended.asm


    0 Warnings
    0 Errors
